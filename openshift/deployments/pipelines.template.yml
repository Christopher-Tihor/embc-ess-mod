apiVersion: v1
kind: Template
metadata:
  name: promotions template
  annotations:
    description: "Pipelines to promote images to higher environments"

objects:
  - kind: "BuildConfig"
    apiVersion: "v1"
    metadata:
      name: "era-promote-test"
    spec:
      strategy:
        jenkinsPipelineStrategy:
          successfulBuildsHistoryLimit: 5
          failedBuildsHistoryLimit: 5
          strategy:
            type: JenkinsPipeline
            jenkinsPipelineStrategy:
              jenkinsfilePath: openshift/deployments/TEST-deployment-Jenkinsfile
      source:
        type: Git
        git:
          uri: "https://github.com/ytqsl/embc-ess-mod.git"
          ref: master
      runPolicy: Serial

  - kind: "BuildConfig"
    apiVersion: "v1"
    metadata:
      name: "era-promote-train"
    spec:
      strategy:
        jenkinsPipelineStrategy:
          successfulBuildsHistoryLimit: 5
          failedBuildsHistoryLimit: 5
          strategy:
            type: JenkinsPipeline
            jenkinsPipelineStrategy:
              jenkinsfilePath: openshift/deployments/TRAIN-deployment-Jenkinsfile
      source:
        type: Git
        git:
          uri: "https://github.com/bcgov/embc-ess-mod.git"
          ref: master
      runPolicy: Serial

  - kind: "BuildConfig"
    apiVersion: "v1"
    metadata:
      name: "era-promote-prod"
    spec:
      strategy:
        jenkinsPipelineStrategy:
          successfulBuildsHistoryLimit: 100
          failedBuildsHistoryLimit: 10
          strategy:
            type: JenkinsPipeline
            jenkinsPipelineStrategy:
              jenkinsfilePath: openshift/deployments/PROD-deployment-Jenkinsfile
      source:
        type: Git
        git:
          uri: "https://github.com/bcgov/embc-ess-mod.git"
          ref: master
      runPolicy: Serial
